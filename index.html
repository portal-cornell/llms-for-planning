<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Query-Efficient Planning with Language Models">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Query-Efficient Planning with Language Models</title>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-QR88D4MJ0H"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
  
    gtag('config', 'G-QR88D4MJ0H');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/icon.jpg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>

<section class="hero">
  <div class="hero-body flex-container">
    <img src="./static/images/portal_logo.png" width="10%">
    <img src="./static/images/cornell_logo.png" width="25%" style="float: right">
  </div>
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Query-Efficient Planning with <br> Language Models</h1>
        
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://gonzalogonzalezpumariega.com">Gonzalo Gonzalez-Pumariega</a>,</span>
            <span class="author-block">
                <a href="https://portal.cs.cornell.edu/people/">Wayne Chen</a>,</span>
            <span class="author-block">
                <a href="https://kushal2000.github.io/">Kushal Kedia</a>,</span>
            <span class="author-block">
                <a href="https://www.sanjibanchoudhury.com/">Sanjiban Choudhury</a>            
          </div>

          <div class="column has-text-centered">
            
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper (TBD)</span>
                </a>
              </span>
              <!-- arXiv Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv (TBD)</span>
                </a>
              </span>
              <!-- twitter Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-x-twitter"></i>
                  </span>
                  <span>Summary (TBD)</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-code"></i>
                  </span>
                  <span>Code (TBD)</span>
                </a>
              </span>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section class="hero">
    <div class="hero-body">
        <div class="container is-max-desktop">
          <div style="display: flex; justify-content: center; align-items: center; max-height: 50vh">
            <div style="flex: 1; text-align: center;">
              <figure>
                <img src="./static/gifs/boomerang_1100.gif" alt="Boomerang" style="max-height: 50vh; width: auto; object-fit: cover;">
                <figcaption><b>Boomerang</b></figcaption>
              </figure>
            </div>
            <div style="flex: 1; text-align: center;">
              <figure>
                <img src="./static/gifs/react_1100.gif" alt="ReAct" style="max-height: 50vh; width: auto; object-fit: cover;">
                <figcaption><b>ReAct</b></figcaption>
              </figure>
            </div>
            <div style="flex: 2; text-align: center;">
              <figure>
                <img src="./static/gifs/toi_bfs_1100.gif" alt="ToI-BFS" style="max-height: 50vh; width: auto; object-fit: cover;">
                <figcaption><b>Tree of Interaction BFS</b></figcaption>
              </figure>
            </div>
          </div>          
        <!-- <div style="display: flex; justify-content: center; align-items: center;">
          <div style="flex: 1; text-align: center;">
            <b>Boomerang</b>
          </div>
          <div style="flex: 1; text-align: center;">
            <b>ReAct</b>
          </div>
          <div style="flex: 3; text-align: center;">
            <b>Tree of Interaction BFS</b>
          </div>
        </div> -->
          <div class="column has-text-centered">
              <br><br>
              <p> An example run of LLM planners on Blocksworld where a stack of blocks is rearranged into a new stack.
                  <b>Boomerang</b> achieves success while remaining query-efficient.
                  <b>ReAct</b> is query-efficient but cycles over visited states leading to a step limit failure.
                  <b>Tree of Interaction BFS</b> is query-inefficient and cycles excessively.
              </p>
          </div>
        </div>
    </div>
</section>
<!-- reduce line spacing below -->

<section class="section">
    <div class="container is-max-desktop">
        <!-- Abstract. -->
        <div class="columns is-centered has-text-centered">
            <div class="column is-four-fifths">
                <h2 class="title is-3">Abstract</h2>
                <div class="content has-text-justified">
                    <p>Planning in complex environments requires an agent to efficiently query a world model 
                      to find a feasible sequence of actions from start to goal. Recent work has shown that 
                      Large Language Models (LLMs), with their rich prior knowledge and reasoning capabilities,
                      can potentially help with planning by searching over promising states and adapting to
                      feedback from the world. 
                      <br><br>
                      In this paper, we propose and study two fundamentally competing frameworks that leverage
                      LLMs for query-efficient planning. The first uses LLMs as a <i>heuristic</i> within a 
                      search-based planner to select promising nodes to expand and propose promising actions. 
                      The second uses LLMs as a <i>generative planner</i> to propose an entire sequence of 
                      actions, query the world model, and adapt based on feedback.
                      <br><br>
                      We show that while both approaches improve upon comparable baselines, using an LLM as a 
                      generative planner results in significantly fewer world model queries. Our key finding is 
                      that the LLM as a planner can more rapidly <i>adapt</i> its planning strategies based on 
                      immediate feedback than LLM as a heuristic. We present evaluations and ablations on
                      Robotouille and PDDL planning benchmarks and discuss connections to existing theory on
                      query-efficient planning algorithms.</p>
                </div>
            </div>
        </div>
    </div>
</section>


<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Overview</h2>
        <!-- <div class="publication-video"> -->
          
          <p style="text-align: left;">
            <b>ReAct</b> prompting -- where a policy takes as input the current observation 
            and past history of interactions and then outputs an action -- serves as a simple
            recipe for query-efficient planning with LLMs; however, <b>ReAct</b> policies are 
            susceptible to getting trapped in local optima. A more flexible approach, 
            <b>ReAct-Select</b>, outputs a state and an action which provides the ability 
            to escape local optima yet uses a larger decision space making it intractable to use.
          </p>
          <br>
          <img src="./static/images/main.png">
          <br>
          <p style="text-align: left;">
            <b>Tree of Interaction</b> utilizes LLMs as a heuristic within an external planner. 
            The planner maintains a search tree and invokes the LLM to choose which states to expand
            and what actions to propose. By judiciously choosing which states to expand, the LLM minimizes
            unnecessary queries to the world model to guide the search tree towards the goal. We implement a
            beam search planner using best-first search (<b>ToI-BFS</b>) and a depth-first search planner 
            (<b>ToI-DFS</b>).
          </p>
          <br>
          <p style="text-align: left;">
            Instead of restricting the use of LLM agents within an external planner, <b>Boomerang</b> uses 
            an LLM as a generative planner that adapts to feedback from the world model. The LLM planner
            proposes a sequence of actions from the start to the goal state based on its internal world model's
            understanding of the problem domain. Then, it receives feedback from the true world model, which in
            turn updates the internal world model.
          </p>
      </div>
    </div>

    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Results</h2>
      </div>
    </div>

    <div class="columns is-centered has-text-centered">
      <div class="column is-three-fifths">
        <img src="./static/images/success.png">
      </div>
      <div class="column is-three-fifths">
        <img src="./static/images/optimality.png">
      </div>
    </div>
    
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
          <p style="text-align: left;">
            We evaluate non-interactive approaches (I/O, I/O + CoT), LLM as heuristic approaches (ToI-BFS, ToI-DFS),
            classical planners (Classical) and LLM as generative planner approaches (ReAct, Boomerang) on 600
            Blocksworld problems in PlanBench. Success is calculated as runs that reach the goal within 20 world
            model queries. We observe <b>Boomerang</b> achieves the highest success and optimality over query-efficient
            runs.</p>
        </div>
    </div>

    <div class="columns is-centered has-text-centered" style="width: 130%; margin-left: -15%;">
      <div class="columns">
        <img src="./static/images/success_others.png">
        </div>
    </div>
          
    <div class="columns is-centered has-text-centered">
      <div class="column">
          <p style="text-align: left;">
            We evaluate the best LLM as heuristic, classical, and LLM as generative planner approaches
            on 100 problems in Logistics, Grippers, and Robotouille and plot cumulative success rates
            with varying world model queries limits. Classical approaches using FastDownward can only
            work on PDDL representations which Robotouille lack. <b>Boomerang</b> achieves the highest
            cumulative success over all domains.
          </p>
      </div>
    </div>

    <div class="columns is-centered has-text-centered">
      <div class="column is-two-fifths">
        <img src="./static/images/react_failure.png">
        <b>ReAct Failure</b>
      </div>
      <div class="column is-two-fifths">
        <img src="./static/images/react_select_failure.png">
        <b>ReAct-Select Failure</b>
      </div>
      <div class="column is-two-fifths">
        <img src="./static/images/boomerang_success.png">
        <b>Boomerang Success</b>
      </div>
    </div>
    
    <div class="columns is-centered has-text-centered">
      <div class="column">
          <p style="text-align: left;">
            We also qualitatively observe that despite <b>ReAct</b> keeping all interactions in history,
            it exhibits a <i>recency bias</i> to feedback and endlessly cycles. We note the same
            phenomenon in <b>ReAct-Select</b>, which exhibits a <i>recency bias</i> to recent states
            and degenerates to <b>ReAct</b>. <b>Boomerang</b>, on the other hand, reasons over entire
            trajectories and so can better adapt to feedback.
          </p>
      </div>
    </div>

<section class="section">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column" id="Paper">
        <h2 class="title is-3">Paper</h2>
    <div class="paper-thumbnail">
        <a href="">
            <img class="layered-paper-big" width="100%" src="./static/images/query_efficient_preview.png" alt="Paper thumbnail"/>
        </a>
    </div>
    <div class="paper-info">
        <h3 class="title is-4" style="text-align: center;">BibTex</h3>
        <pre style="overflow-x:hidden; text-wrap:wrap; white-space: pre-wrap;">
          <code>
          TODO
          </code>
        </pre> 
      </div>
    </div>
  </div>
</section>

<br>


<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content has-text-centered">
          <p>
            Website template borrowed from <a
              href="https://github.com/nerfies/nerfies.github.io">NeRFies</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>